<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CN_CHomeworks1: FtpServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CN_CHomeworks1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classFtpServer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FtpServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>implemention of fpt server  
 <a href="classFtpServer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ftpserver_8h_source.html">ftpserver.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for FtpServer:</div>
<div class="dyncontent">
<div class="center"><img src="classFtpServer__coll__graph.png" border="0" usemap="#aFtpServer_coll__map" alt="Collaboration graph"/></div>
<map name="aFtpServer_coll__map" id="aFtpServer_coll__map">
<area shape="rect" title="implemention of fpt server" alt="" coords="5,160,196,575"/>
<area shape="rect" href="classMyLogger.html" title="Costumized log class. It has been designed to be a replacement of std::clog. This class can print log..." alt="" coords="41,5,160,97"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a34fda18aeef3d5dce9c748788c86fb7b"><td class="memItemLeft" align="right" valign="top"><a id="a34fda18aeef3d5dce9c748788c86fb7b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a34fda18aeef3d5dce9c748788c86fb7b">getLastFd</a> ()</td></tr>
<tr class="memdesc:a34fda18aeef3d5dce9c748788c86fb7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">get largest file descriptor. it will be used for <code>select</code> method <br /></td></tr>
<tr class="separator:a34fda18aeef3d5dce9c748788c86fb7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04a6c4609d3367876998c7ee708dae06"><td class="memItemLeft" align="right" valign="top"><a id="a04a6c4609d3367876998c7ee708dae06"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a04a6c4609d3367876998c7ee708dae06">setLastFd</a> (int val)</td></tr>
<tr class="memdesc:a04a6c4609d3367876998c7ee708dae06"><td class="mdescLeft">&#160;</td><td class="mdescRight">set largest file descriptor. it will be used for <code>select</code> method <br /></td></tr>
<tr class="separator:a04a6c4609d3367876998c7ee708dae06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a52a02943c90a48e215c860f1a1698a"><td class="memItemLeft" align="right" valign="top"><a id="a9a52a02943c90a48e215c860f1a1698a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a9a52a02943c90a48e215c860f1a1698a">generateNewDataPort</a> ()</td></tr>
<tr class="memdesc:a9a52a02943c90a48e215c860f1a1698a"><td class="mdescLeft">&#160;</td><td class="mdescRight">generate new data port by incresing last assigned dataport and return it <br /></td></tr>
<tr class="separator:a9a52a02943c90a48e215c860f1a1698a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b40297bf864e8967b72ca008ce7c34"><td class="memItemLeft" align="right" valign="top"><a id="a55b40297bf864e8967b72ca008ce7c34"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a55b40297bf864e8967b72ca008ce7c34">start</a> ()</td></tr>
<tr class="memdesc:a55b40297bf864e8967b72ca008ce7c34"><td class="mdescLeft">&#160;</td><td class="mdescRight">start ftp server. <br /></td></tr>
<tr class="separator:a55b40297bf864e8967b72ca008ce7c34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b5910461b6cca5166b1f9dbff72045"><td class="memItemLeft" align="right" valign="top"><a id="ad5b5910461b6cca5166b1f9dbff72045"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#ad5b5910461b6cca5166b1f9dbff72045">end</a> ()</td></tr>
<tr class="memdesc:ad5b5910461b6cca5166b1f9dbff72045"><td class="mdescLeft">&#160;</td><td class="mdescRight">shutdown the ftp server <br /></td></tr>
<tr class="separator:ad5b5910461b6cca5166b1f9dbff72045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d5e4fdbeb87c1dec373e2cf204c21e1"><td class="memItemLeft" align="right" valign="top"><a id="a6d5e4fdbeb87c1dec373e2cf204c21e1"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a6d5e4fdbeb87c1dec373e2cf204c21e1">importConfigFromFile</a> ()</td></tr>
<tr class="memdesc:a6d5e4fdbeb87c1dec373e2cf204c21e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">import config.json <br /></td></tr>
<tr class="separator:a6d5e4fdbeb87c1dec373e2cf204c21e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f70c6eec30c21e73d83bb9fa96245b2"><td class="memItemLeft" align="right" valign="top"><a id="a3f70c6eec30c21e73d83bb9fa96245b2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a3f70c6eec30c21e73d83bb9fa96245b2">event_loop</a> ()</td></tr>
<tr class="memdesc:a3f70c6eec30c21e73d83bb9fa96245b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">check for trigger on unix sockets by select method. if an event has been accoured run <code>onEventOccur</code> method. <br /></td></tr>
<tr class="separator:a3f70c6eec30c21e73d83bb9fa96245b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a01efda1b1f92795caf79e465504ff7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a9a01efda1b1f92795caf79e465504ff7">onEventOccur</a> (int fdIter)</td></tr>
<tr class="memdesc:a9a01efda1b1f92795caf79e465504ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">general event handler of the ftp server we split event states in this function and call suitable function: if it was about data channel (file pipes) -&gt; <code>onNewFilePipeEvent</code> if it was a new connection request -&gt; <code>acceptNewClient</code> if it was a disconnect event -&gt; <code>disconnectClient</code> if it was a command from connected client -&gt; <code>onNewApiCommandRecived</code>  <a href="classFtpServer.html#a9a01efda1b1f92795caf79e465504ff7">More...</a><br /></td></tr>
<tr class="separator:a9a01efda1b1f92795caf79e465504ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afedceb5790f61ac0735f3b56e08ae3ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#afedceb5790f61ac0735f3b56e08ae3ac">acceptNewClient</a> ()</td></tr>
<tr class="memdesc:afedceb5790f61ac0735f3b56e08ae3ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">accept new client this method will be called new client detected in <code>onEventOccur</code> function.  <a href="classFtpServer.html#afedceb5790f61ac0735f3b56e08ae3ac">More...</a><br /></td></tr>
<tr class="separator:afedceb5790f61ac0735f3b56e08ae3ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace73727e0cd6c2c1afe2b3231938d985"><td class="memItemLeft" align="right" valign="top"><a id="ace73727e0cd6c2c1afe2b3231938d985"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#ace73727e0cd6c2c1afe2b3231938d985">disconnectClient</a> (int clientFd)</td></tr>
<tr class="memdesc:ace73727e0cd6c2c1afe2b3231938d985"><td class="mdescLeft">&#160;</td><td class="mdescRight">remove disconnected client in the method we remove it from <code>fdSet</code> and from <code>onlineUsers</code> fields. and close it file descriptor. <br /></td></tr>
<tr class="separator:ace73727e0cd6c2c1afe2b3231938d985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ede6fb318e6ddd3372bf4d3a89422d"><td class="memItemLeft" align="right" valign="top"><a id="a60ede6fb318e6ddd3372bf4d3a89422d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>removeOnlineUser</b> (int fd)</td></tr>
<tr class="separator:a60ede6fb318e6ddd3372bf4d3a89422d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23518add78808244304693bdb3eb086f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a23518add78808244304693bdb3eb086f">onNewPacketRecived</a> (int fdIter, char *recvBuf)</td></tr>
<tr class="memdesc:a23518add78808244304693bdb3eb086f"><td class="mdescLeft">&#160;</td><td class="mdescRight">event handler of clients commands.  <a href="classFtpServer.html#a23518add78808244304693bdb3eb086f">More...</a><br /></td></tr>
<tr class="separator:a23518add78808244304693bdb3eb086f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f95168d1072daeeb165d85a6ba917a8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a5f95168d1072daeeb165d85a6ba917a8">checkSyntax</a> (stringstream &amp;ss)</td></tr>
<tr class="memdesc:a5f95168d1072daeeb165d85a6ba917a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">check recived command syntax issues.  <a href="classFtpServer.html#a5f95168d1072daeeb165d85a6ba917a8">More...</a><br /></td></tr>
<tr class="separator:a5f95168d1072daeeb165d85a6ba917a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c944e7e77d41676becc1dce8c31e37f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structAccountInfo.html">AccountInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a0c944e7e77d41676becc1dce8c31e37f">findAccountInfo</a> (std::string user, std::string pass)</td></tr>
<tr class="memdesc:a0c944e7e77d41676becc1dce8c31e37f"><td class="mdescLeft">&#160;</td><td class="mdescRight">find account with given username and password  <a href="classFtpServer.html#a0c944e7e77d41676becc1dce8c31e37f">More...</a><br /></td></tr>
<tr class="separator:a0c944e7e77d41676becc1dce8c31e37f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94526b019b5b57d039cf2d14da871da2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a94526b019b5b57d039cf2d14da871da2">addOnlineUser</a> (int fd, <a class="el" href="structAccountInfo.html">AccountInfo</a> account)</td></tr>
<tr class="memdesc:a94526b019b5b57d039cf2d14da871da2"><td class="mdescLeft">&#160;</td><td class="mdescRight">after login add this client to online users  <a href="classFtpServer.html#a94526b019b5b57d039cf2d14da871da2">More...</a><br /></td></tr>
<tr class="separator:a94526b019b5b57d039cf2d14da871da2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ece2ab1b9d05e14ef2504c6a4cdcf4f"><td class="memItemLeft" align="right" valign="top"><a id="a3ece2ab1b9d05e14ef2504c6a4cdcf4f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a3ece2ab1b9d05e14ef2504c6a4cdcf4f">addFilePipe</a> (<a class="el" href="classFilePipe.html">FilePipe</a> *pipe)</td></tr>
<tr class="memdesc:a3ece2ab1b9d05e14ef2504c6a4cdcf4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">add file pipe while starting upload/download <br /></td></tr>
<tr class="separator:a3ece2ab1b9d05e14ef2504c6a4cdcf4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72558dfda809d3073574401386494876"><td class="memItemLeft" align="right" valign="top"><a id="a72558dfda809d3073574401386494876"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a72558dfda809d3073574401386494876">removeFilePipe</a> (<a class="el" href="classFilePipe.html">FilePipe</a> *pipe)</td></tr>
<tr class="memdesc:a72558dfda809d3073574401386494876"><td class="mdescLeft">&#160;</td><td class="mdescRight">remove file pipe while finishing upload/download <br /></td></tr>
<tr class="separator:a72558dfda809d3073574401386494876"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28a909fdc7d4e35ca46b0561dfe16ab5"><td class="memItemLeft" align="right" valign="top"><a id="a28a909fdc7d4e35ca46b0561dfe16ab5"></a>
<a class="el" href="classUser.html">User</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a28a909fdc7d4e35ca46b0561dfe16ab5">findUser</a> (int fd)</td></tr>
<tr class="memdesc:a28a909fdc7d4e35ca46b0561dfe16ab5"><td class="mdescLeft">&#160;</td><td class="mdescRight">find user by file descriptor <br /></td></tr>
<tr class="separator:a28a909fdc7d4e35ca46b0561dfe16ab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17121774c050dcc69a55b29718c03c3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a17121774c050dcc69a55b29718c03c3f">apiSendMessage</a> (int fd, string commandName, int code, std::string <a class="el" href="structmessage.html">message</a>)</td></tr>
<tr class="memdesc:a17121774c050dcc69a55b29718c03c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">prepare and respnose message to the clients  <a href="classFtpServer.html#a17121774c050dcc69a55b29718c03c3f">More...</a><br /></td></tr>
<tr class="separator:a17121774c050dcc69a55b29718c03c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572cab2431d53f2a1dc13be3323aa56e"><td class="memItemLeft" align="right" valign="top"><a id="a572cab2431d53f2a1dc13be3323aa56e"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>makeResponseMessage</b> (int code, std::string text)</td></tr>
<tr class="separator:a572cab2431d53f2a1dc13be3323aa56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfb1bcd63cd6f25458d8ca396c75b69"><td class="memItemLeft" align="right" valign="top"><a id="a3bfb1bcd63cd6f25458d8ca396c75b69"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isAdminFile</b> (std::string fileName)</td></tr>
<tr class="separator:a3bfb1bcd63cd6f25458d8ca396c75b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc38468fe27c0719156c84c784dd7b16"><td class="memItemLeft" align="right" valign="top"><a id="afc38468fe27c0719156c84c784dd7b16"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#afc38468fe27c0719156c84c784dd7b16">onNewApiCommandRecived</a> (int fd, char *buffer, int len)</td></tr>
<tr class="memdesc:afc38468fe27c0719156c84c784dd7b16"><td class="mdescLeft">&#160;</td><td class="mdescRight">event handler while new command message recived from clients <br /></td></tr>
<tr class="separator:afc38468fe27c0719156c84c784dd7b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ca6849246745e3dce4fc0c5a1298462"><td class="memItemLeft" align="right" valign="top"><a id="a5ca6849246745e3dce4fc0c5a1298462"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a5ca6849246745e3dce4fc0c5a1298462">onNewUserCheckRequest</a> (int fd, char *buffer, int len)</td></tr>
<tr class="memdesc:a5ca6849246745e3dce4fc0c5a1298462"><td class="mdescLeft">&#160;</td><td class="mdescRight">response to <code>user</code> command from the client <br /></td></tr>
<tr class="separator:a5ca6849246745e3dce4fc0c5a1298462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4e5cdafbac232017b4a4b3dc04532b"><td class="memItemLeft" align="right" valign="top"><a id="a2a4e5cdafbac232017b4a4b3dc04532b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a2a4e5cdafbac232017b4a4b3dc04532b">onNewLoginRequest</a> (int fd, char *buffer, int len)</td></tr>
<tr class="memdesc:a2a4e5cdafbac232017b4a4b3dc04532b"><td class="mdescLeft">&#160;</td><td class="mdescRight">response to <code>pass</code> command from the client <br /></td></tr>
<tr class="separator:a2a4e5cdafbac232017b4a4b3dc04532b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ae230121cf87ce36ddf43b91f3f066"><td class="memItemLeft" align="right" valign="top"><a id="ac3ae230121cf87ce36ddf43b91f3f066"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>onLsRequest</b> (int fd, char *buffer, int len)</td></tr>
<tr class="separator:ac3ae230121cf87ce36ddf43b91f3f066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7136a5a9b3e485eaf21f24b7832685af"><td class="memItemLeft" align="right" valign="top"><a id="a7136a5a9b3e485eaf21f24b7832685af"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a7136a5a9b3e485eaf21f24b7832685af">onRetrRequest</a> (int fd, char *buffer, int len)</td></tr>
<tr class="memdesc:a7136a5a9b3e485eaf21f24b7832685af"><td class="mdescLeft">&#160;</td><td class="mdescRight">response to <code>retr</code> command from the client <br /></td></tr>
<tr class="separator:a7136a5a9b3e485eaf21f24b7832685af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94cb9ae6e8079ddd170316965dcc9a0c"><td class="memItemLeft" align="right" valign="top"><a id="a94cb9ae6e8079ddd170316965dcc9a0c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a94cb9ae6e8079ddd170316965dcc9a0c">sendRetrAck</a> (int fd)</td></tr>
<tr class="memdesc:a94cb9ae6e8079ddd170316965dcc9a0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">response send ack after download to the client <br /></td></tr>
<tr class="separator:a94cb9ae6e8079ddd170316965dcc9a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d04e01f6994076d54843f439b65ebbf"><td class="memItemLeft" align="right" valign="top"><a id="a6d04e01f6994076d54843f439b65ebbf"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a6d04e01f6994076d54843f439b65ebbf">onUploadRequest</a> (int fd, char *buffer, int len)</td></tr>
<tr class="memdesc:a6d04e01f6994076d54843f439b65ebbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">response to <code>upload</code> command <br /></td></tr>
<tr class="separator:a6d04e01f6994076d54843f439b65ebbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a554d8196921ceb34b4c31afe1de858f5"><td class="memItemLeft" align="right" valign="top"><a id="a554d8196921ceb34b4c31afe1de858f5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a554d8196921ceb34b4c31afe1de858f5">sendUploadAck</a> (int fd)</td></tr>
<tr class="memdesc:a554d8196921ceb34b4c31afe1de858f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">send ack after upload to the client <br /></td></tr>
<tr class="separator:a554d8196921ceb34b4c31afe1de858f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadefbc9eb93b1921224875c745c353c"><td class="memItemLeft" align="right" valign="top"><a id="afadefbc9eb93b1921224875c745c353c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#afadefbc9eb93b1921224875c745c353c">sendSyntaxMessage</a> (int fd, string commandName)</td></tr>
<tr class="memdesc:afadefbc9eb93b1921224875c745c353c"><td class="mdescLeft">&#160;</td><td class="mdescRight">send syntax error to the client <br /></td></tr>
<tr class="separator:afadefbc9eb93b1921224875c745c353c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac4ba345cfd15a21bce0e98e90ba0ec"><td class="memItemLeft" align="right" valign="top"><a id="abac4ba345cfd15a21bce0e98e90ba0ec"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#abac4ba345cfd15a21bce0e98e90ba0ec">onHelpRequest</a> (int fd, char *buffer, int len)</td></tr>
<tr class="memdesc:abac4ba345cfd15a21bce0e98e90ba0ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">response <code>help</code> command <br /></td></tr>
<tr class="separator:abac4ba345cfd15a21bce0e98e90ba0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaf5c49670024edd5db61c923165449f"><td class="memItemLeft" align="right" valign="top"><a id="aaaf5c49670024edd5db61c923165449f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#aaaf5c49670024edd5db61c923165449f">onQuitRequest</a> (int fd, char *buffer, int len)</td></tr>
<tr class="memdesc:aaaf5c49670024edd5db61c923165449f"><td class="mdescLeft">&#160;</td><td class="mdescRight">response <code>quit</code> command <br /></td></tr>
<tr class="separator:aaaf5c49670024edd5db61c923165449f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04da38b74ab1d7b443a0ab3ed4226631"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a04da38b74ab1d7b443a0ab3ed4226631">apiSend</a> (int fd, string commandName, char *args, int argLen)</td></tr>
<tr class="memdesc:a04da38b74ab1d7b443a0ab3ed4226631"><td class="mdescLeft">&#160;</td><td class="mdescRight">send command in api form  <a href="classFtpServer.html#a04da38b74ab1d7b443a0ab3ed4226631">More...</a><br /></td></tr>
<tr class="separator:a04da38b74ab1d7b443a0ab3ed4226631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b5872e6010d98e0188a4fd766e8b8d"><td class="memItemLeft" align="right" valign="top"><a id="a78b5872e6010d98e0188a4fd766e8b8d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a78b5872e6010d98e0188a4fd766e8b8d">apiSend</a> (int fd, std::string commandName, string str)</td></tr>
<tr class="memdesc:a78b5872e6010d98e0188a4fd766e8b8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">simiular with void <a class="el" href="classFtpServer.html#a04da38b74ab1d7b443a0ab3ed4226631" title="send command in api form">apiSend(int fd, string commandName, char *args, int argLen)</a>; <br /></td></tr>
<tr class="separator:a78b5872e6010d98e0188a4fd766e8b8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4563eba690ac58ab4710b65b90057ca"><td class="memItemLeft" align="right" valign="top"><a id="ad4563eba690ac58ab4710b65b90057ca"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#ad4563eba690ac58ab4710b65b90057ca">exportCommandName</a> (char *buff, int recivedLen)</td></tr>
<tr class="memdesc:ad4563eba690ac58ab4710b65b90057ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">export command name from recived client message <br /></td></tr>
<tr class="separator:ad4563eba690ac58ab4710b65b90057ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e496d0f571c5152a10a445bdf38842"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a93e496d0f571c5152a10a445bdf38842">onNewFilePipeEvent</a> (int pipeIter)</td></tr>
<tr class="memdesc:a93e496d0f571c5152a10a445bdf38842"><td class="mdescLeft">&#160;</td><td class="mdescRight">event handler when new block of file recived  <a href="classFtpServer.html#a93e496d0f571c5152a10a445bdf38842">More...</a><br /></td></tr>
<tr class="separator:a93e496d0f571c5152a10a445bdf38842"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a99924a0c4ebe8bf10454d4617e15ae9b"><td class="memItemLeft" align="right" valign="top"><a id="a99924a0c4ebe8bf10454d4617e15ae9b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a99924a0c4ebe8bf10454d4617e15ae9b">addAccountInfo</a> (const <a class="el" href="structAccountInfo.html">AccountInfo</a> &amp;account)</td></tr>
<tr class="memdesc:a99924a0c4ebe8bf10454d4617e15ae9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">add account info after reading from the file <br /></td></tr>
<tr class="separator:a99924a0c4ebe8bf10454d4617e15ae9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b1fce94f1806c0568e095788c678d6"><td class="memItemLeft" align="right" valign="top"><a id="ae3b1fce94f1806c0568e095788c678d6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#ae3b1fce94f1806c0568e095788c678d6">addFdSet</a> (int fd)</td></tr>
<tr class="memdesc:ae3b1fce94f1806c0568e095788c678d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">add file descriptor to the <code>fdSet</code> private member <br /></td></tr>
<tr class="separator:ae3b1fce94f1806c0568e095788c678d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac5dd9d9b8f9e5ccc5fd979c35d2b770"><td class="memItemLeft" align="right" valign="top"><a id="aac5dd9d9b8f9e5ccc5fd979c35d2b770"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#aac5dd9d9b8f9e5ccc5fd979c35d2b770">removeFdSet</a> (int fd)</td></tr>
<tr class="memdesc:aac5dd9d9b8f9e5ccc5fd979c35d2b770"><td class="mdescLeft">&#160;</td><td class="mdescRight">remove given file descriptor from the <code>fdSet</code> private member <br /></td></tr>
<tr class="separator:aac5dd9d9b8f9e5ccc5fd979c35d2b770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac7911c327dc15c13f66b7e030fc363"><td class="memItemLeft" align="right" valign="top"><a id="abac7911c327dc15c13f66b7e030fc363"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#abac7911c327dc15c13f66b7e030fc363">initLogFile</a> ()</td></tr>
<tr class="memdesc:abac7911c327dc15c13f66b7e030fc363"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize logger <code>mlog</code> <br /></td></tr>
<tr class="separator:abac7911c327dc15c13f66b7e030fc363"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a954d3430486e83395d03bd70626e36da"><td class="memItemLeft" align="right" valign="top"><a id="a954d3430486e83395d03bd70626e36da"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a954d3430486e83395d03bd70626e36da">controlPort</a></td></tr>
<tr class="memdesc:a954d3430486e83395d03bd70626e36da"><td class="mdescLeft">&#160;</td><td class="mdescRight">command channel port <br /></td></tr>
<tr class="separator:a954d3430486e83395d03bd70626e36da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dbc50f4b29694cc6f0bafd08f93f458"><td class="memItemLeft" align="right" valign="top"><a id="a0dbc50f4b29694cc6f0bafd08f93f458"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a0dbc50f4b29694cc6f0bafd08f93f458">serverFd</a></td></tr>
<tr class="memdesc:a0dbc50f4b29694cc6f0bafd08f93f458"><td class="mdescLeft">&#160;</td><td class="mdescRight">command channel file descriptor <br /></td></tr>
<tr class="separator:a0dbc50f4b29694cc6f0bafd08f93f458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57f124c30cc5592f46b82434fb6f730"><td class="memItemLeft" align="right" valign="top"><a id="ad57f124c30cc5592f46b82434fb6f730"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#ad57f124c30cc5592f46b82434fb6f730">lastFd</a></td></tr>
<tr class="memdesc:ad57f124c30cc5592f46b82434fb6f730"><td class="mdescLeft">&#160;</td><td class="mdescRight">largest file descriptor. it will be used for <code>select</code> method <br /></td></tr>
<tr class="separator:ad57f124c30cc5592f46b82434fb6f730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d9a9c546eaf05d1399d8b458a7c40c6"><td class="memItemLeft" align="right" valign="top"><a id="a1d9a9c546eaf05d1399d8b458a7c40c6"></a>
fd_set&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a1d9a9c546eaf05d1399d8b458a7c40c6">fdSet</a></td></tr>
<tr class="memdesc:a1d9a9c546eaf05d1399d8b458a7c40c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">unix fd_set for storing all file descriptors. it will be used for <code>select</code> method <br /></td></tr>
<tr class="separator:a1d9a9c546eaf05d1399d8b458a7c40c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb2dd6c27a5cae40871eafc1e7f33bc"><td class="memItemLeft" align="right" valign="top"><a id="a8fb2dd6c27a5cae40871eafc1e7f33bc"></a>
unordered_map&lt; std::string, <a class="el" href="structAccountInfo.html">AccountInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a8fb2dd6c27a5cae40871eafc1e7f33bc">accountsMap</a></td></tr>
<tr class="memdesc:a8fb2dd6c27a5cae40871eafc1e7f33bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">to access user account info by username <br /></td></tr>
<tr class="separator:a8fb2dd6c27a5cae40871eafc1e7f33bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f13592f4c0b80fbf2090982f3af4fe"><td class="memItemLeft" align="right" valign="top"><a id="a63f13592f4c0b80fbf2090982f3af4fe"></a>
unordered_map&lt; int, <a class="el" href="classUser.html">User</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a63f13592f4c0b80fbf2090982f3af4fe">onlineUsers</a></td></tr>
<tr class="memdesc:a63f13592f4c0b80fbf2090982f3af4fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">to access online users by file descriptor <br /></td></tr>
<tr class="separator:a63f13592f4c0b80fbf2090982f3af4fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3510d1d3b5016cc058576f15bb2dfce5"><td class="memItemLeft" align="right" valign="top"><a id="a3510d1d3b5016cc058576f15bb2dfce5"></a>
unordered_map&lt; int, <a class="el" href="classFilePipe.html">FilePipe</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a3510d1d3b5016cc058576f15bb2dfce5">filepipes</a></td></tr>
<tr class="memdesc:a3510d1d3b5016cc058576f15bb2dfce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">file pipes. for downloading and uploading. the key is file descriptor of data socket <br /></td></tr>
<tr class="separator:a3510d1d3b5016cc058576f15bb2dfce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d75a24f38f904eece8c91a2e79ff18c"><td class="memItemLeft" align="right" valign="top"><a id="a1d75a24f38f904eece8c91a2e79ff18c"></a>
set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a1d75a24f38f904eece8c91a2e79ff18c">adminFiles</a></td></tr>
<tr class="memdesc:a1d75a24f38f904eece8c91a2e79ff18c"><td class="mdescLeft">&#160;</td><td class="mdescRight">a set of string that stores admin-access files <br /></td></tr>
<tr class="separator:a1d75a24f38f904eece8c91a2e79ff18c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d11df479e64cd18449cece1eae945d9"><td class="memItemLeft" align="right" valign="top"><a id="a5d11df479e64cd18449cece1eae945d9"></a>
unordered_map&lt; int, std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a5d11df479e64cd18449cece1eae945d9">loginReqSet</a></td></tr>
<tr class="memdesc:a5d11df479e64cd18449cece1eae945d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">a map to store clients user commands. after user command, clients will be stored within their input username. and we check them in login time. key: client file descriptor value: client input user name <br /></td></tr>
<tr class="separator:a5d11df479e64cd18449cece1eae945d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa1264e825492fd0a8118e9d3955e54"><td class="memItemLeft" align="right" valign="top"><a id="adaa1264e825492fd0a8118e9d3955e54"></a>
<a class="el" href="classMyLogger.html">MyLogger</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#adaa1264e825492fd0a8118e9d3955e54">mlog</a></td></tr>
<tr class="memdesc:adaa1264e825492fd0a8118e9d3955e54"><td class="mdescLeft">&#160;</td><td class="mdescRight">costumized log class instance <br /></td></tr>
<tr class="separator:adaa1264e825492fd0a8118e9d3955e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39ce002efe9f67241d923dcad5ba8ba9"><td class="memItemLeft" align="right" valign="top"><a id="a39ce002efe9f67241d923dcad5ba8ba9"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFtpServer.html#a39ce002efe9f67241d923dcad5ba8ba9">lastDataPort</a></td></tr>
<tr class="memdesc:a39ce002efe9f67241d923dcad5ba8ba9"><td class="mdescLeft">&#160;</td><td class="mdescRight">we store the last assigned data port for transfering data. <br /></td></tr>
<tr class="separator:a39ce002efe9f67241d923dcad5ba8ba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>implemention of fpt server </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="afedceb5790f61ac0735f3b56e08ae3ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afedceb5790f61ac0735f3b56e08ae3ac">&#9670;&nbsp;</a></span>acceptNewClient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FtpServer::acceptNewClient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>accept new client this method will be called new client detected in <code>onEventOccur</code> function. </p>
<dl class="section return"><dt>Returns</dt><dd>client file descriptor </dd></dl>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                               {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    sockaddr_in clientAddr;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">int</span> clientControlFd;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    socklen_t addrSize = <span class="keyword">sizeof</span>(clientAddr);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    clientControlFd = accept(<a class="code" href="classFtpServer.html#a0dbc50f4b29694cc6f0bafd08f93f458">serverFd</a>, (<span class="keyword">struct</span> sockaddr *)&amp;clientAddr, &amp;addrSize);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classFtpServer.html#ae3b1fce94f1806c0568e095788c678d6">addFdSet</a>(clientControlFd);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classFtpServer.html#adaa1264e825492fd0a8118e9d3955e54">mlog</a>&lt;&lt;<span class="stringliteral">&quot;new client accepted &quot;</span>&lt;&lt;clientControlFd&lt;&lt;mendl;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="aclassFtpServer_html_a0dbc50f4b29694cc6f0bafd08f93f458"><div class="ttname"><a href="classFtpServer.html#a0dbc50f4b29694cc6f0bafd08f93f458">FtpServer::serverFd</a></div><div class="ttdeci">int serverFd</div><div class="ttdoc">command channel file descriptor</div><div class="ttdef"><b>Definition:</b> ftpserver.h:29</div></div>
<div class="ttc" id="aclassFtpServer_html_adaa1264e825492fd0a8118e9d3955e54"><div class="ttname"><a href="classFtpServer.html#adaa1264e825492fd0a8118e9d3955e54">FtpServer::mlog</a></div><div class="ttdeci">MyLogger mlog</div><div class="ttdoc">costumized log class instance</div><div class="ttdef"><b>Definition:</b> ftpserver.h:46</div></div>
<div class="ttc" id="aclassFtpServer_html_ae3b1fce94f1806c0568e095788c678d6"><div class="ttname"><a href="classFtpServer.html#ae3b1fce94f1806c0568e095788c678d6">FtpServer::addFdSet</a></div><div class="ttdeci">void addFdSet(int fd)</div><div class="ttdoc">add file descriptor to the fdSet private member</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:17</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94526b019b5b57d039cf2d14da871da2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94526b019b5b57d039cf2d14da871da2">&#9670;&nbsp;</a></span>addOnlineUser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FtpServer::addOnlineUser </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structAccountInfo.html">AccountInfo</a>&#160;</td>
          <td class="paramname"><em>account</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>after login add this client to online users </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>client file descriptor </td></tr>
    <tr><td class="paramname">account</td><td>account information of loginned user </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">auto</span> newUser = <span class="keyword">new</span> <a class="code" href="classUser.html">User</a>(account);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classFtpServer.html#a63f13592f4c0b80fbf2090982f3af4fe">onlineUsers</a>.emplace(fd,newUser);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
<div class="ttc" id="aclassFtpServer_html_a63f13592f4c0b80fbf2090982f3af4fe"><div class="ttname"><a href="classFtpServer.html#a63f13592f4c0b80fbf2090982f3af4fe">FtpServer::onlineUsers</a></div><div class="ttdeci">unordered_map&lt; int, User * &gt; onlineUsers</div><div class="ttdoc">to access online users by file descriptor</div><div class="ttdef"><b>Definition:</b> ftpserver.h:33</div></div>
<div class="ttc" id="aclassUser_html"><div class="ttname"><a href="classUser.html">User</a></div><div class="ttdoc">stores all users information. used in FtpServer class. we use this class after user login to manage u...</div><div class="ttdef"><b>Definition:</b> user.h:10</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04da38b74ab1d7b443a0ab3ed4226631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04da38b74ab1d7b443a0ab3ed4226631">&#9670;&nbsp;</a></span>apiSend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FtpServer::apiSend </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>commandName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>send command in api form </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>client file descriptor </td></tr>
    <tr><td class="paramname">commandName</td><td>command name identifier </td></tr>
    <tr><td class="paramname">args</td><td>argument of command </td></tr>
    <tr><td class="paramname">argLen</td><td>length of the argument part </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a17121774c050dcc69a55b29718c03c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17121774c050dcc69a55b29718c03c3f">&#9670;&nbsp;</a></span>apiSendMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FtpServer::apiSendMessage </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>commandName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>prepare and respnose message to the clients </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">code</td><td>status code e.g. 200, 404 ... </td></tr>
    <tr><td class="paramname">status</td><td>message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string that has been made to send with <code>send</code> method </dd></dl>
<div class="fragment"><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">string</span> args = makeResponseMessage(code,<a class="code" href="structmessage.html">message</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="classFtpServer.html#a04da38b74ab1d7b443a0ab3ed4226631">apiSend</a>(fd,commandName,args);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div>
<div class="ttc" id="aclassFtpServer_html_a04da38b74ab1d7b443a0ab3ed4226631"><div class="ttname"><a href="classFtpServer.html#a04da38b74ab1d7b443a0ab3ed4226631">FtpServer::apiSend</a></div><div class="ttdeci">void apiSend(int fd, string commandName, char *args, int argLen)</div><div class="ttdoc">send command in api form</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:249</div></div>
<div class="ttc" id="astructmessage_html"><div class="ttname"><a href="structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> serverMain.cpp:19</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f95168d1072daeeb165d85a6ba917a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f95168d1072daeeb165d85a6ba917a8">&#9670;&nbsp;</a></span>checkSyntax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FtpServer::checkSyntax </td>
          <td>(</td>
          <td class="paramtype">stringstream &amp;&#160;</td>
          <td class="paramname"><em>ss</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check recived command syntax issues. </p>
<dl class="section return"><dt>Returns</dt><dd>false if it has syntax error. otherwise true. </dd></dl>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">//check until now we recived all arguments from stringstream correcly</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span>(!ss){</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">//no argument is left</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">string</span> temp;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    ss&gt;&gt;temp;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">return</span> !ss;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c944e7e77d41676becc1dce8c31e37f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c944e7e77d41676becc1dce8c31e37f">&#9670;&nbsp;</a></span>findAccountInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structAccountInfo.html">AccountInfo</a> FtpServer::findAccountInfo </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>pass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find account with given username and password </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>input username </td></tr>
    <tr><td class="paramname">pass</td><td>input password </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a9a01efda1b1f92795caf79e465504ff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a01efda1b1f92795caf79e465504ff7">&#9670;&nbsp;</a></span>onEventOccur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FtpServer::onEventOccur </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fdIter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>general event handler of the ftp server we split event states in this function and call suitable function: if it was about data channel (file pipes) -&gt; <code>onNewFilePipeEvent</code> if it was a new connection request -&gt; <code>acceptNewClient</code> if it was a disconnect event -&gt; <code>disconnectClient</code> if it was a command from connected client -&gt; <code>onNewApiCommandRecived</code> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fdIter</td><td>triggered file descriptor. we discovered it by iteration in the <code>event_loop</code> method. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                      {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">auto</span> pipeIter = <a class="code" href="classFtpServer.html#a3510d1d3b5016cc058576f15bb2dfce5">filepipes</a>.find(fdIter);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span>(pipeIter != <a class="code" href="classFtpServer.html#a3510d1d3b5016cc058576f15bb2dfce5">filepipes</a>.end()){<span class="comment">// transferring data event</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//        mlog&lt;&lt;&quot;pipe event&quot;&lt;&lt;mendl;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="classFtpServer.html#a93e496d0f571c5152a10a445bdf38842">onNewFilePipeEvent</a>(fdIter);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">char</span> recvBuf[RECEIVE_BUFFER_SIZE];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    memset(recvBuf, NULL , RECEIVE_BUFFER_SIZE);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (fdIter == <a class="code" href="classFtpServer.html#a0dbc50f4b29694cc6f0bafd08f93f458">serverFd</a>){ <span class="comment">//new client</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classFtpServer.html#afedceb5790f61ac0735f3b56e08ae3ac">acceptNewClient</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">int</span> recvChars = recv(fdIter , recvBuf, RECEIVE_BUFFER_SIZE, 0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (recvChars == 0) {<span class="comment">//client disconnected</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="classFtpServer.html#ace73727e0cd6c2c1afe2b3231938d985">disconnectClient</a>(fdIter);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="classFtpServer.html#afc38468fe27c0719156c84c784dd7b16">onNewApiCommandRecived</a>(fdIter,recvBuf,recvChars); <span class="comment">//new command from connected client</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    memset(recvBuf, NULL , RECEIVE_BUFFER_SIZE);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
<div class="ttc" id="aclassFtpServer_html_a3510d1d3b5016cc058576f15bb2dfce5"><div class="ttname"><a href="classFtpServer.html#a3510d1d3b5016cc058576f15bb2dfce5">FtpServer::filepipes</a></div><div class="ttdeci">unordered_map&lt; int, FilePipe * &gt; filepipes</div><div class="ttdoc">file pipes. for downloading and uploading. the key is file descriptor of data socket</div><div class="ttdef"><b>Definition:</b> ftpserver.h:36</div></div>
<div class="ttc" id="aclassFtpServer_html_a93e496d0f571c5152a10a445bdf38842"><div class="ttname"><a href="classFtpServer.html#a93e496d0f571c5152a10a445bdf38842">FtpServer::onNewFilePipeEvent</a></div><div class="ttdeci">void onNewFilePipeEvent(int pipeIter)</div><div class="ttdoc">event handler when new block of file recived</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:301</div></div>
<div class="ttc" id="aclassFtpServer_html_ace73727e0cd6c2c1afe2b3231938d985"><div class="ttname"><a href="classFtpServer.html#ace73727e0cd6c2c1afe2b3231938d985">FtpServer::disconnectClient</a></div><div class="ttdeci">void disconnectClient(int clientFd)</div><div class="ttdoc">remove disconnected client in the method we remove it from fdSet and from onlineUsers fields....</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:135</div></div>
<div class="ttc" id="aclassFtpServer_html_afc38468fe27c0719156c84c784dd7b16"><div class="ttname"><a href="classFtpServer.html#afc38468fe27c0719156c84c784dd7b16">FtpServer::onNewApiCommandRecived</a></div><div class="ttdeci">void onNewApiCommandRecived(int fd, char *buffer, int len)</div><div class="ttdoc">event handler while new command message recived from clients</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:279</div></div>
<div class="ttc" id="aclassFtpServer_html_afedceb5790f61ac0735f3b56e08ae3ac"><div class="ttname"><a href="classFtpServer.html#afedceb5790f61ac0735f3b56e08ae3ac">FtpServer::acceptNewClient</a></div><div class="ttdeci">void acceptNewClient()</div><div class="ttdoc">accept new client this method will be called new client detected in onEventOccur function.</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:123</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a93e496d0f571c5152a10a445bdf38842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93e496d0f571c5152a10a445bdf38842">&#9670;&nbsp;</a></span>onNewFilePipeEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FtpServer::onNewFilePipeEvent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pipeIter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>event handler when new block of file recived </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">piepIter</td><td>file descriptor of data channel </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">auto</span> pipe = <a class="code" href="classFtpServer.html#a3510d1d3b5016cc058576f15bb2dfce5">filepipes</a>[pipeIter];</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">int</span> len = pipe-&gt;eventloop();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span>(len == 0){ <span class="comment">// transferring data completed</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span>(pipe-&gt;getDir() == FilePipe::sender)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="classFtpServer.html#a94cb9ae6e8079ddd170316965dcc9a0c">sendRetrAck</a>(pipe-&gt;getUserFd());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="classFtpServer.html#a554d8196921ceb34b4c31afe1de858f5">sendUploadAck</a>(pipe-&gt;getUserFd());</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        pipe-&gt;endConnection();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="classFtpServer.html#a72558dfda809d3073574401386494876">removeFilePipe</a>(pipe);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="ttc" id="aclassFtpServer_html_a554d8196921ceb34b4c31afe1de858f5"><div class="ttname"><a href="classFtpServer.html#a554d8196921ceb34b4c31afe1de858f5">FtpServer::sendUploadAck</a></div><div class="ttdeci">void sendUploadAck(int fd)</div><div class="ttdoc">send ack after upload to the client</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:508</div></div>
<div class="ttc" id="aclassFtpServer_html_a72558dfda809d3073574401386494876"><div class="ttname"><a href="classFtpServer.html#a72558dfda809d3073574401386494876">FtpServer::removeFilePipe</a></div><div class="ttdeci">void removeFilePipe(FilePipe *pipe)</div><div class="ttdoc">remove file pipe while finishing upload/download</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:222</div></div>
<div class="ttc" id="aclassFtpServer_html_a94cb9ae6e8079ddd170316965dcc9a0c"><div class="ttname"><a href="classFtpServer.html#a94cb9ae6e8079ddd170316965dcc9a0c">FtpServer::sendRetrAck</a></div><div class="ttdeci">void sendRetrAck(int fd)</div><div class="ttdoc">response send ack after download to the client</div><div class="ttdef"><b>Definition:</b> ftpserver.cpp:459</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a23518add78808244304693bdb3eb086f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23518add78808244304693bdb3eb086f">&#9670;&nbsp;</a></span>onNewPacketRecived()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FtpServer::onNewPacketRecived </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fdIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>recvBuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>event handler of clients commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fdIter</td><td>file descriptor of the client </td></tr>
    <tr><td class="paramname">recvBuf</td><td>reciving buffer </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                                           {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classFtpServer.html#adaa1264e825492fd0a8118e9d3955e54">mlog</a>&lt;&lt;<span class="stringliteral">&quot;new packet from &quot;</span>&lt;&lt;fdIter&lt;&lt;<span class="stringliteral">&quot;: &quot;</span>&lt;&lt;recvBuf&lt;&lt;mendl;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>FTP/server/<a class="el" href="ftpserver_8h_source.html">ftpserver.h</a></li>
<li>FTP/server/ftpserver.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
